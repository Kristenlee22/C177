# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.176010467719, 0.176010467719,0.176010467719,0.176010467719,0.057990504167,0.057990504167,0.0459910588164,0.0432976225898,0.0432976225898,0.0432976225898,0.0432976225898,0.0432976225898,0.0432976225898,0.0432976225898,0.0432976225898,0.0432976225898,0.0459395564835,0.0459395564835,0.0459395564835,0.0442433161328,0.0459395564835,0.102269153088,0.103024969375,0.116219972925,0.116219972925,0.103024969375,0.102186850665,0.102186850665,0.103024969375,0.102186850665,0.144440356568,0.148040439791,0.148040439791,0.148040439791,0.148760513076,0.143036256299,0.143036256299,0.155447381753,0.125602283967,0.12141377534,0.125602283967,0.12141377534,0.12141377534,0.12141377534,0.0898285874252,0.119998054083,0.115595648215,0.114557185058,0.0966167084125,0.0966167084125,0.0966167084125,0.0904675083232,0.0839325863182,0.0839325863182,0.0839325863182)
L_hpd_M95=c(0.354301677101, 0.354301677101,0.354301677101,0.354301677101,0.318032757892,0.303182096332,0.266429615908,0.128476903098,0.116219972925,0.116219972925,0.116219972925,0.116219972925,0.116219972925,0.116219972925,0.116219972925,0.116219972925,0.122503568875,0.123753588211,0.123753588211,0.151045946736,0.21706923445,0.278384791186,0.259565396288,0.26609464297,0.26609464297,0.253576003117,0.253576003117,0.253576003117,0.253576003117,0.253576003117,0.332252618464,0.349557897987,0.349557897987,0.353010375604,0.373897623687,0.385879760655,0.385879760655,0.397075821695,0.372518345166,0.385879760655,0.397075821695,0.406492550223,0.424828946822,0.434392872326,0.424828946822,0.467967054042,0.467967054042,0.467967054042,0.467967054042,0.467967054042,0.467967054042,0.467967054042,0.467967054042,0.467967054042,0.467967054042)
M_hpd_m95=c(0.786180958232, 0.786180958232,0.0806391579901,0.0806391579901,0.0806391579901,0.0862386314719,0.0806391579901,0.0746841349036,0.0806391579901,0.0822129511316,0.0739284819178,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0800309516936,0.0762242280581,0.0746264904329,0.0674953843518,0.0629467172199,0.062746286887,0.0629467172199,0.0629467172199,0.0629467172199,0.066096231739,0.0481506908147,0.0369328592829,0.0369328592829,0.0369328592829,0.0328461951152,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881,0.0108304666881)
M_hpd_M95=c(1.52956563368, 1.52956563368,0.206757066487,0.206757066487,0.206757066487,0.206757066487,0.186202796064,0.160522441143,0.155157217259,0.155157217259,0.135156823251,0.125855563551,0.125855563551,0.125855563551,0.125855563551,0.125855563551,0.125855563551,0.125855563551,0.125855563551,0.125855563551,0.125099943332,0.125855563551,0.125099943332,0.125099943332,0.125099943332,0.120682846824,0.120682846824,0.120682846824,0.120682846824,0.120682846824,0.125099943332,0.123437450605,0.125099943332,0.136322736976,0.136322736976,0.141447023676,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976,0.136322736976)
R_hpd_m95=c(-1.28673461882, -1.28673461882,-0.0124510525589,-0.0124510525589,-0.117992955018,-0.120185734054,-0.122162499974,-0.107964123986,-0.110494140703,-0.110494140703,-0.0799590838393,-0.0746128218645,-0.069410144396,-0.069410144396,-0.069410144396,-0.0732480724268,-0.0732480724268,-0.0672072179767,-0.0672072179767,-0.0732480724268,-0.06021970924,-0.019002329038,0.0128728040035,0.0128728040035,0.00830929430881,0.00730451049572,0.00543250203688,0.00543250203688,0.00543250203688,0.00167635757001,0.0340741132678,0.0457873255277,0.0457873255277,0.0417394773545,0.0493356429581,0.0463708458534,0.0463708458534,0.0463708458534,0.044329885953,0.044329885953,0.044329885953,0.044329885953,0.016256487932,0.0196184003573,0.016256487932,0.016256487932,0.016256487932,0.0196184003573,0.016256487932,0.016256487932,0.0196184003573,0.0196184003573,0.016256487932,0.016256487932,0.016256487932)
R_hpd_M95=c(-0.493293072199, -0.493293072199,0.227525207368,0.227525207368,0.222102149946,0.213430578181,0.158919151493,0.034483374834,0.00830929430881,0.00306401893833,0.0281064650903,0.0133665131225,0.0180020993573,0.0180020993573,0.0180020993573,0.013118052112,0.013118052112,0.0150364631433,0.0150364631433,0.0500606591592,0.126668432133,0.154777482752,0.174621470871,0.174621470871,0.16658770529,0.16658770529,0.16658770529,0.16658770529,0.16658770529,0.16658770529,0.245932764368,0.268272972708,0.268272972708,0.268272972708,0.310760788985,0.324409215336,0.324409215336,0.324409215336,0.346654175838,0.354417015335,0.369135019275,0.374166865479,0.354417015335,0.376430012829,0.376430012829,0.38922900209,0.38922900209,0.401711957697,0.401711957697,0.401711957697,0.401711957697,0.401711957697,0.401711957697,0.401711957697,0.401711957697)
L_mean=c(0.253034641483, 0.253034641483,0.253034641483,0.253034641483,0.228480856823,0.183831184416,0.116664861828,0.0772514956265,0.074982217562,0.074982217562,0.0749164491988,0.0749831014546,0.0748711212421,0.0749330614907,0.0749330614907,0.0751200361355,0.0755295303331,0.0767503805881,0.0767503805881,0.0814980615273,0.125097686964,0.194066793565,0.197429359333,0.197832096,0.197561672964,0.189965632143,0.189042518795,0.188888579495,0.188830390517,0.189371160466,0.210609021522,0.223530368536,0.229329416611,0.234702741441,0.245339630625,0.247706790338,0.248619070871,0.248636017425,0.245710861806,0.243252470275,0.243700057782,0.247622153397,0.250181575731,0.252128158156,0.24870917688,0.251005265153,0.250170867684,0.251765626637,0.253962493685,0.254539845809,0.255395437033,0.255877835201,0.258056450873,0.258056450873,0.258056450873)
M_mean=c(1.1181709025, 1.1181709025,0.13486372193,0.13486372193,0.13486372193,0.133044403274,0.123324530317,0.114908165249,0.112380352531,0.110978022873,0.107651553462,0.104475566813,0.104230895186,0.104230895186,0.104349450869,0.104349450869,0.104349450869,0.104349450869,0.104349450869,0.104393739675,0.103771997977,0.103277783897,0.101775046983,0.100382725912,0.0995271341596,0.0992786336272,0.0990702509812,0.0988355343436,0.0988744701502,0.0988295337871,0.0986636423994,0.0925542554929,0.0876815248457,0.0864684537423,0.0858864683816,0.0841510066335,0.0810981041101,0.0810981041101,0.0810981041101,0.0810981041101,0.0810981041101,0.0810981041101,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801,0.0809842306801)
R_mean=c(-0.865136261021, -0.865136261021,0.118170919553,0.118170919553,0.0936171348933,0.0507867811424,-0.00665966848849,-0.0376566696229,-0.0373981349686,-0.0359958053107,-0.0327351042628,-0.0294924653583,-0.0293597739438,-0.0292978336952,-0.0294163893787,-0.0292294147338,-0.0288199205362,-0.0275990702813,-0.0275990702813,-0.0228956781478,0.021325688987,0.0907890096685,0.0956543123498,0.0974493700885,0.0980345388048,0.0906869985154,0.0899722678134,0.0900530451513,0.0899559203665,0.0905416266792,0.111945379123,0.130976113043,0.141647891765,0.148234287699,0.159453162244,0.163555783705,0.167520966761,0.167537913315,0.164612757696,0.162154366165,0.162601953671,0.166524049287,0.169197345051,0.171143927476,0.1677249462,0.170021034473,0.169186637004,0.170781395957,0.172978263005,0.173555615129,0.174411206353,0.174893604521,0.177072220193,0.177072220193,0.177072220193)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.514763759447), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.68252219705), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.4154080807, 0.441883153467), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()