# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.132404042425, 0.132404042425,0.132404042425,0.134240242113,0.121384757124,0.0708262285181,0.0480726517056,0.0543053552223,0.0550442341102,0.0543053552223,0.0545605642354,0.0553732470527,0.055657395459,0.055657395459,0.055657395459,0.055657395459,0.0571028587001,0.0573685448488,0.0583580792939,0.0613291228802,0.0659835017574,0.0825772465474,0.0861428922332,0.100056624331,0.124385717649,0.124385717649,0.12772348933,0.127077975432,0.122984277529,0.126395045025,0.124385717649,0.12772348933,0.129261472387,0.131158924568,0.142293223426,0.135650128329,0.142664406278,0.136074424243,0.130238262419,0.123660316602,0.129328765238,0.130238262419,0.130238262419,0.12425591392,0.129612413494,0.123257698577,0.123257698577,0.123660316602,0.123257698577)
L_hpd_M95=c(0.341663758745, 0.341663758745,0.341663758745,0.3453535533,0.350022010439,0.331892259672,0.161286192551,0.144276264666,0.14373518463,0.14161050673,0.14161050673,0.140974575525,0.140974575525,0.140974575525,0.140974575525,0.140974575525,0.150036745032,0.159079252233,0.176082001111,0.199017341067,0.227570287053,0.246215633264,0.24735172381,0.25842082977,0.259726696765,0.258676396318,0.260986919915,0.259893501025,0.258881269515,0.269592458903,0.275680493405,0.310251558925,0.347327267359,0.358877926303,0.386271631187,0.386423554242,0.400398752143,0.401111740673,0.401111740673,0.401111740673,0.412471954596,0.418875463737,0.424073187049,0.429883635742,0.438167510186,0.433114236666,0.435415806692,0.437153615985,0.437153615985)
M_hpd_m95=c(0.869197263669, 0.869197263669,0.087555837007,0.0878429338172,0.0870122989556,0.0879325395895,0.0878429338172,0.0860607171603,0.0867758652366,0.0868184377933,0.0868811366582,0.0870122989556,0.0865878550671,0.0867009725357,0.0867758652366,0.0865878550671,0.0865878550671,0.0867758652366,0.0873801834466,0.0874520692892,0.0874520692892,0.0874520692892,0.0873801834466,0.0873801834466,0.0873801834466,0.0878292421852,0.0873801834466,0.0868184377933,0.0868811366582,0.0867758652366,0.0861696606878,0.0844266935729,0.0816322312556,0.0816322312556,0.0814490866019,0.0815522417191,0.0792085442989,0.0792085442989,0.0790030168947,0.0816322312556,0.0815522417191,0.0815522417191,0.0790030168947,0.0775809344179,0.0775809344179,0.0775809344179,0.0775809344179,0.0775809344179,0.0775809344179)
M_hpd_M95=c(1.48906662884, 1.48906662884,0.185540319481,0.186666296815,0.187350280096,0.185540319481,0.182297822357,0.152807359521,0.138217292267,0.135149448647,0.135118815459,0.135149448647,0.132927602666,0.131776461024,0.130604992523,0.12967944689,0.12967944689,0.12967944689,0.130099849525,0.130099849525,0.130099849525,0.130099849525,0.130099849525,0.130099849525,0.130099849525,0.130604992523,0.130099849525,0.12990533787,0.130604992523,0.131520818826,0.131520818826,0.131430184325,0.131430184325,0.132288593155,0.132288593155,0.133375120901,0.131400128543,0.131520818826,0.131520818826,0.134617204249,0.134617204249,0.13495358607,0.13563517858,0.138310090022,0.138310090022,0.138310090022,0.138310090022,0.138310090022,0.138310090022)
R_hpd_m95=c(-1.22582792478, -1.22582792478,0.0114947331479,0.0114947331479,-0.0153552565524,-0.0606556785475,-0.125778155875,-0.0785396731405,-0.0672913735049,-0.0672913735049,-0.0669682195484,-0.0662069147114,-0.0648512139576,-0.0650107285985,-0.0651707659591,-0.0587571108009,-0.0596274793483,-0.0587571108009,-0.0598535321415,-0.0552897258965,-0.0450090332141,-0.0326128385087,-0.0246382552514,-0.0082768888818,0.0132617540738,0.0107040804361,0.015017639915,0.00971704430533,0.011736399512,0.0146365706814,0.0107084094077,0.00932543198925,0.0242025240709,0.025237385551,0.0311172116581,0.0283101413447,0.0296982775622,0.0172113940746,0.0315990886659,0.0315990886659,0.025237385551,0.0172113940746,0.0172113940746,0.0172113940746,0.0138115878731,0.0130541992915,0.011736399512,0.0130541992915,0.0130541992915)
R_hpd_M95=c(-0.575409915603, -0.575409915603,0.232274799556,0.234939267109,0.231474336263,0.232419216937,0.0632018834872,0.0490314801364,0.040142290268,0.0345938272162,0.0344616575078,0.0345938272162,0.0336487883814,0.0331493141115,0.0323557167085,0.0386404142768,0.0446913876841,0.0562260531721,0.0700669091884,0.095289762221,0.126108110799,0.138570946489,0.143260530842,0.153498655411,0.153843086841,0.150658806446,0.153843086841,0.148683687789,0.153498655411,0.164857458347,0.166813082534,0.20002025262,0.250352172726,0.261779484139,0.283150577117,0.284896842296,0.29626925148,0.291515955343,0.311920653507,0.316276945791,0.316276945791,0.313020550264,0.316505506495,0.32689405183,0.32689405183,0.327222319688,0.32858607176,0.330870410935,0.331567787499)
L_mean=c(0.262864906811, 0.262864906811,0.262893486777,0.262257310394,0.257209982279,0.227345792085,0.094987706219,0.090069763302,0.0897424640791,0.0898523019584,0.0900352958219,0.0906189491615,0.0906208205485,0.0908301235573,0.0909944395566,0.0914286262245,0.093547751729,0.0968645770483,0.101372477803,0.114601190581,0.142830653601,0.171798844485,0.180383906802,0.189569066922,0.198345338267,0.198333576925,0.197806392445,0.197408017896,0.197975724549,0.200548711281,0.203072578731,0.21384765999,0.224846453232,0.229991177327,0.240228568712,0.243181163666,0.245266740166,0.246651301216,0.248972019315,0.250524017878,0.25162461029,0.251902988309,0.253151466872,0.25407567833,0.253917413074,0.253936441699,0.253772360106,0.253905379131,0.254105274079)
M_mean=c(1.15648376761, 1.15648376761,0.122845202646,0.123040604112,0.123180700528,0.122500814816,0.120796890313,0.115381883719,0.112485418738,0.111590898577,0.111488502988,0.111381012182,0.110925108116,0.110497379957,0.110141038894,0.109781267703,0.109585864489,0.109487066817,0.109636357628,0.1096565937,0.1096565937,0.1096565937,0.109663841282,0.109663841282,0.109663841282,0.109651639933,0.109638339013,0.109432213121,0.109223831531,0.108923594726,0.108801754952,0.108441630205,0.108001203825,0.108033450753,0.107951097229,0.107854879571,0.107793604248,0.107754060947,0.107747041243,0.107644915149,0.107611788288,0.107523353667,0.106867534162,0.106459224535,0.106459224535,0.106459224535,0.106459224535,0.106459224535,0.106459224535)
R_mean=c(-0.893618860803, -0.893618860803,0.140048284131,0.139216706282,0.134029281751,0.104844977269,-0.0258091840943,-0.0253121204173,-0.0227429546591,-0.0217385966191,-0.0214532071665,-0.0207620630204,-0.0203042875675,-0.0196672564002,-0.0191465993371,-0.0183526414784,-0.0160381127601,-0.0126224897687,-0.00826387982515,0.00494459688006,0.0331740599003,0.0621422507846,0.0707200655194,0.0799052256396,0.0886814969842,0.0886819369925,0.0881680534327,0.0879758047748,0.0887518930179,0.0916251165557,0.0942708237788,0.105406029785,0.116845249407,0.121957726574,0.132277471483,0.135326284094,0.137473135918,0.13889724027,0.141224978072,0.142879102729,0.144012822002,0.144379634642,0.146283932711,0.147616453795,0.14745818854,0.147477217164,0.147313135571,0.147446154596,0.147646049545)
trans=0.5
age=(0:(49-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.481984261205), xlim = c(-51.45,2.45), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.63797329172), xlim = c(-51.45,2.45), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.34841071726, 0.364724566248), xlim = c(-51.45,2.45), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-51.45,2.45), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()